---
title: "Midterm Project"
author: "Phoebe Mo"
date: "2020-10-23"
output: github_document
---

```{r setup, include = FALSE}
library(tidyverse)
library(patchwork)
library(readxl)
library(readr)
library(rvest)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = 0.6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis",
  digits = 4
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

This is a midterm project intending to analyze the weight of three pet dogs. Now,
I'm going to import the data, tidy, and clean the data.

```{r}
weight_data = 
  read_excel("./data/dogweights_07sept2020 (1).xlsx", range = "B2:F207",
             col_types = c("date", "guess", "guess", "guess", "guess")) %>%
  janitor::clean_names() %>%
  drop_na(date) %>%
  subset(raisin != "NA" | simone != "NA" | gagne != "NA") %>%
  separate(date, into = c("year", "month", "day"), sep = "-") %>%
  pivot_longer(
    raisin:gagne,
    names_to = "name",
    values_to = "weight"
  ) %>%
  mutate(
    weight = str_replace(weight, "1810", "18 10"),
    weight = str_replace(weight, "1803", "18 03")
  ) %>%
  separate(weight, into = c("pound", "ounce"), sep = " ") %>%
  separate(std, into = c("std_pound", "std_ounce"), sep = " ") %>%
  mutate(
    pound = as.numeric(pound),
    ounce = as.numeric(ounce),
    weight = pound + ounce / 16,
    std_pound = as.numeric(std_pound),
    std_ounce = as.numeric(std_ounce),
    std = std_pound + std_ounce / 16
  ) %>%
  select(year, month, day, name, weight, std)
```

The raw data is in excel format and the "Date" variable has multiple forms of expressions, so when importing it, I unify them in a single form of expression.

Then, I unify the expressions of the names of columns and drop rows that has no date information as well as rows that has NA in all three dogs' weight. Since there is only one row that has no date entry, and rows that has no weight record for all three dogs are useless, this removal has trivial impact on our later analysis.

I separate the date into year, month, and day for a better view. Noticing that the raw data is in a wide format where all three pets' names are the column names which is not tidy, I make it into a long format. I also convert the weight unit into solely "pounds", replacing the confusing format of two numbers(pounds and ounces) in the raw data. Finally, I rearrange the columns to present information for a more understanding view.

Now, create a second data frame containing notes in the raw data and save the two data frames into csv files.

```{r}
note_data = 
  read_excel("./data/dogweights_07sept2020 (1).xlsx", range = "B2:G207",
             col_types = c("date", "guess", "guess", "guess", "guess", "guess")) %>%
  janitor::clean_names() %>%
  select(-c(raisin, simone, gagne, std)) %>%
  rename(note = x6) %>%
  drop_na(note) %>%
  separate(date, into = c("year", "month", "day"), sep = "-")

write_csv(weight_data, "./data/tidy_weights.csv")
write_csv(note_data, "./data/tidy_notes.csv")
```

In the tidy dataset containing weights, there are totally `r nrow(weight_data)` rows and each row is a weight information for a single dog in a single day. Columns include variables of the date, name, weight(pounds), and the weight of a standard object. There are `r nrow(count(weight_data, year, month, day))` unique dates included. Following is a table showing the number of observations for each dog, along with their average weight and standard deviation.

```{r}
weight_data %>%
  group_by(name) %>% 
  summarise(
    num = sum(!is.na(weight)),
    avg_weight = mean(weight, na.rm = T),
    sd_weight = sd(weight, na.rm = T)
  )
```

